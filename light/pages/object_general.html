
<div class="view_items d-flex flex-column bg-white">

    <!-- header -->
    <div class="view_header d-flex drop_shadow_md position-relative bg-white">
        <div class="d-flex align-self-center">

            <!-- Mobile btn -->
            <div class="mobile_button black"></div>

            <div class="d-flex line_normal align-items-center font_5 font_bold text-uppercase">
                <span class="d-none d-md-block"><i class="fas fa-home pr-2"></i></span>
                <span class="d-none d-md-block" id="header_object_name"></span>
                <span class="d-md-none d-block view_header_mobile_label">
                    <i class="fas fa-home pr-2"></i>Apartment with
                    balcony
                </span>
            </div>
        </div>

        <!-- right shortcuts -->
        <div class="align-self-center ml-auto" id="header_navbar_right_shrotcuts"></div>
    </div>

    <!-- Filter -->
    <div class="filter_general"></div>

    <!-- Page -->
    <div class="view_content bg_silver position-relative pt-1">

        <!-- Loading -->
        <div id="objects_general_content_loading" class="view_loading" style="display: none;">
            <img src="/assets/images/icons/loading.svg" />
        </div>

        <!-- Content -->
        <div class="content general pt-3">
            <div class="row">
                <div class="col-xl-8 col-md-6">
                    <div class="row">
                        <div class="col-xl-6">

                            <!-- Location -->
                            <div class="card">
                                <div class="card-header d-flex justify-content-between">
                                    <div class="font-weight-bold">
                                        <i class="fas fa-map-marker-alt pr-2"></i>Location
                                    </div>
                                    <div class="d-flex">
                                        <div class="card-header_arrow"></div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="d-flex pb-3">
                                        <a class="card-body_image cursor_point" href="">
                                            <img src="/assets/images/pictures/no-image02.png"
                                                 alt="" id="object_general_location_main_picture">
                                        </a>
                                        <div class="ml-3">
                                            <div id="object_general_unit_name"><strong></strong></div>
                                            <div id="object_general_adress"></div>
                                            <div><span id="object_general_city"></span>&nbsp;<span id="object_general_city_zip"></span></div>
                                            <div id="object_general_country"></div>

                                        </div>

                                    </div>
                                    <a class="cursor_point mb-3" href="" id="object_general_location_details_link">
                                        <button class="btn btn-primary" style="background-color: #457b9d; border-color: #457b9d; ">Open location</button>
                                    </a>
                                    <div class="card_note mb-3 font_3 hidden mt-3" id="object_general_location_note_div">
                                        <div class="font-weight-bold text-uppercase border-bottom mb-2">
                                            <i class="far fa-clipboard pr-2"></i>Note
                                        </div>
                                        <div id="object_general_location_note">
                                        </div>
                                    </div>
                                    <div class="mb-3 font_3 pt-4" id="object_general_owner_container">
                                        <div class="font-weight-bold text-uppercase border-bottom mb-2">
                                            <i class="far fa-address-book pr-2"></i>Owner's contact
                                        </div>
                                        <div class="pb-1">
                                            <i class="fas fa-user pr-2"></i><span id="object_general_owner_name"><strong></strong></span>
                                        </div>
                                        <div class="pb-1">
                                            <a href="mailto:example@example.com" class="card_a">
                                                <i class="fas fa-envelope pr-2"></i><span id="object_general_owner_email"></span>
                                            </a>
                                        </div>
                                        <div>
                                            <a href="tel:+38591000000" class="card_a">
                                                <i class="fas fa-phone pr-2"></i><span id="object_general_owner_tel"></span>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="card_note font_3 hidden pt-4" id="object_general_owner_note_div">
                                        <div class="font-weight-bold text-uppercase border-bottom mb-2">
                                            <i class="far fa-clipboard pr-2"></i>Owner's note
                                        </div>
                                        <div id="object_general_location_owner_note">

                                        </div>
                                    </div>
                                    <!--<div class="pt-2 text-right">
                                        <a href="#location_details" class="btn btn_silver" id="object_general_location_details_link">
                                            <i class="fas fa-edit pr-2"></i>Edit
                                        </a>
                                    </div>-->
                                </div>
                            </div>

                            <!-- Pictures -->
                            <div class="card">
                                <div class="card-header d-flex justify-content-between">
                                    <div class="font-weight-bold"><i class="far fa-images pr-2"></i>Picture</div>
                                    <div class="card-header_arrow"></div>
                                </div>
                                <div class="card-body font_3">
                                    <div class="card-body_main_pic rounded_xl overflow-hidden">
                                        <img style="height: 22rem;"
                                             src="/assets/images/pictures/no-image.png"
                                             alt="" id="object_general_main_picture">
                                    </div>
                                    <hr>
                                </div>
                            </div>

                        </div>
                        <div class="col-xl-6">

                            <!-- Object -->
                            <div class="card">
                                <div class="card-header d-flex justify-content-between">
                                    <div class="font-weight-bold"><i class="fas fa-cube pr-2"></i>Object</div>
                                    <div class="card-header_arrow"></div>
                                </div>
                                <div class="card-body font_3">
                                    <div class="row">

                                        <!-- Name -->
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label class="mb-1">Name</label>
                                                <div class="input-group mb-3">
                                                    <input type="text" class="form-control focus" id="object_general_name">
                                                    <div class="input-group-append" data-toggle="tooltip"
                                                         data-placement="top" data-original-title="Copy">
                                                        <label class="input-group-text cursor_point">
                                                            <i class="far fa-copy"></i>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="width: 100%; display:flex;justify-content: space-between">
                                            <!-- Color -->
                                            <div class="col-sm-6 col-lg-5 col-xl-5">
                                                <div class="form-group">
                                                    <label class="mb-1">Color</label>
                                                    <input type="color" class="form-control focus" id="object_general_color">
                                                </div>
                                            </div>

                                            <!-- Code -->
                                            <div class="col-sm-6 col-lg-4 col-xl-3 hidden">
                                                <div class="form-group">
                                                    <label class="mb-1">Code</label>
                                                    <input type="text" class="form-control focus" id="object_general_code">
                                                </div>
                                            </div>

                                            <!-- Sort Index -->
                                            <div class="col-sm-6 col-lg-4 col-xl-4 hidden">
                                                <div class="form-group">
                                                    <label class="mb-1">Sort index</label>
                                                    <input type="text" class="form-control focus" id="object_general_sort_index">
                                                </div>
                                            </div>

                                            <!-- Category stars -->
                                            <div class="col-sm-6 col-lg-8 col-xl-8 hidden">
                                                <div class="form-group">
                                                    <label class="mb-1">Category stars</label>
                                                    <div id="object_general_select_stars" class="select">
                                                        <button class="custom-select focus" id="location_details_category_stars_btn"></button>
                                                        <i class="fas fa-angle-down"></i>
                                                        <ul class="select_ul hidden" id="location_details_category_stars_dropdown_ul">
                                                            <li class="select_li" data-id="1">
                                                                <div class="select_stars">
                                                                    <i class="fas fa-star"></i>
                                                                </div>
                                                            </li>
                                                            <li class="select_li" data-id="2">
                                                                <div class="select_stars">
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                </div>
                                                            </li>
                                                            <li class="select_li" data-id="3">
                                                                <div class="select_stars">
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                </div>
                                                            </li>
                                                            <li class="select_li" data-id="4">
                                                                <div class="select_stars">
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                </div>
                                                            </li>
                                                            <li class="select_li" data-id="5">
                                                                <div class="select_stars">
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                    <i class="fas fa-star"></i>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Type -->
                                            <div class="col-md-6 col-lg-6 col-xl-6">
                                                <div class="form-group">
                                                    <label class="mb-1">Type</label>
                                                    <div id="select_type" class="select">
                                                        <button class="custom-select focus" id="object_general_types_btn"></button>
                                                        <i class="fas fa-angle-down"></i>
                                                        <ul class="select_ul hidden" id="object_general_types_ul">
                                                            <li class="select_li" data-id="1">Example 01</li>
                                                            <li class="select_li" data-id="2">Example 02</li>
                                                            <li class="select_li" data-id="3">Example 03</li>
                                                            <li class="select_li" data-id="4">Example 04</li>
                                                            <li class="select_li" data-id="5">Example 05</li>
                                                            <li class="select_li" data-id="6">Example 06</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Type label -->
                                            <div class="col-md-6 hidden">
                                                <div class="form-group">
                                                    <label class="mb-1">Type label</label>
                                                    <input type="text" class="form-control focus" id="object_general_type_label">
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="mb-3 font_3 pt-4">
                                        <div class="font-weight-bold text-uppercase border-bottom mb-2">
                                            <i class="far fa-clipboard pr-2"></i>Notes
                                        </div>
                                        <textarea name="" id="object_general_note_object" cols="30" rows="5"
                                                  class="form-control focus font_3"
                                                  placeholder="Note for object"></textarea>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <div class="d-flex justify-content-between">
                                            <div class="mr-2">
                                                <button class="btn btn_red" id="object_deactivate_button" onclick="object_general.bl.deactivate();">
                                                    <i class="far fa-times-circle pr-2"></i>Deactivate
                                                </button>
                                                <button class="btn btn-info" id="object_activate_button" onclick="object_general.bl.activate();">
                                                    <i class="far fa-times-circle pr-2"></i>Activate
                                                </button>
                                            </div>
                                            <button class="btn btn_red" onclick="object_general.bl.delete_object();">
                                                <i class="far fa-times-circle pr-2"></i>Delete
                                            </button>

                                        </div>
                                        <button class="btn btn_secondary" onclick="object_general.bl.save_object();"><i class="fas fa-save pr-2"></i>Save</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Pricing & Calculations -->
                            <div class="card">
                                <div class="card-header d-flex justify-content-between">
                                    <div class="font-weight-bold">
                                        <i class="fas fa-coins pr-2"></i>Pricing & Calculations
                                    </div>
                                    <div class="card-header_arrow"></div>
                                </div>
                                <div class="card-body font_3">
                                    <div class="font-weight-bold text-uppercase border-bottom mb-3 hidden">
                                        <i class="fas fa-coins pr-2"></i>Price
                                    </div>
                                    <div class="row">
                                        <!-- Price calculation -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">Price calculation</label>
                                                <div id="select_price_calculation" class="select">
                                                    <button class="custom-select focus" id="object_general_price_calculation_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_price_calculation_ul">
                                                        <li class="select_li" data-id="R">By object</li>
                                                        <li class="select_li" data-id="P">By person</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Info base price -->
                                        <div class="col-md-6 hidden">
                                            <label class="mb-1">Info base price</label>
                                            <div class="input-group mb-3">
                                                <input type="text" class="form-control focus" id="object_general_info_base_price">
                                                <div class="input-group-append">
                                                    <label class="input-group-text">€</label>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Advance (%) -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">Advance (%)</label>
                                                <input type="text" class="form-control focus" id="object_general_advance_percent">
                                            </div>
                                        </div>
                                        <!-- VAT % -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">VAT %</label>
                                                <input type="text" class="form-control focus" id="object_general_vat">
                                            </div>
                                        </div>
                                        <!-- Tourist member fee -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">Tourist member fee</label>
                                                <input type="text" class="form-control focus" id="object_general_tourist_membership_fee">
                                            </div>
                                        </div>
                                        <!-- Advance VAT % -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">Advance VAT %</label>
                                                <input type="text" class="form-control focus" id="object_general_vat_advance">
                                            </div>
                                        </div>
                                        <!-- Commission (%) -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">Commission (%)</label>
                                                <input type="text" class="form-control focus" id="object_general_owner_provision">
                                            </div>
                                        </div>
                                        <!-- VAT profit % -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">VAT profit %</label>
                                                <input type="text" class="form-control focus" id="object_general_vat_profit">
                                            </div>
                                        </div>
                                        <!-- VAT Calculation -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">VAT calculation</label>
                                                <div id="select_VAT_calculation" class="select">
                                                    <button class="custom-select focus" id="object_general_vat_calculation_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_vat_calculation_ul">
                                                        <li class="select_li" data-id="flat">Flat</li>
                                                        <li class="select_li" data-id="percent_rent">Percent of rent</li>
                                                        <li class="select_li" data-id="percent_fee">Percent of fee</li>
                                                        <li class="select_li" data-id="percent_rent_fee">Percent of rent and fee</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- VAT Neto -->
                                        <div class="col-md-6 hidden">
                                            <div class="form-group">
                                                <label class="mb-1">VAT net price</label>
                                                <input type="text" class="form-control focus" id="object_general_vat_neto">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="font-weight-bold text-uppercase border-bottom mb-3 pt-4 hidden">
                                        <i class="fas fa-calculator pr-2"></i>Calculation
                                    </div>
                                    <div class="row hidden">
                                        <!-- Calculation -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">Calculation</label>
                                                <div id="select_calculation" class="select">
                                                    <button class="custom-select focus" id="object_general_calculation_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_calculation_ul">
                                                        <li class="select_li" data-id="">----</li>
                                                        <li class="select_li" data-id="own">Our property</li>
                                                        <li class="select_li" data-id="their">In their name</li>
                                                        <li class="select_li" data-id="our">In our name</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Commission type -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">Commission type</label>
                                                <div id="select_commission_type" class="select">
                                                    <button class="custom-select focus" id="object_general_commission_type_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_commission_type_ul">
                                                        <li class="select_li" data-id="simple">From rent price</li>
                                                        <li class="select_li" data-id="full">From full price</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Commission calculation -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">Commission calculation</label>
                                                <div id="select_commission_calculation" class="select">
                                                    <button class="custom-select focus" id="object_general_commision_calculation_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_commision_calculation_ul">
                                                        <li class="select_li" data-id="normal">Normal</li>
                                                        <li class="select_li" data-id="vat_remove">Remove VAT</li>
                                                        <li class="select_li" data-id="vat_add">Add VAT</li>
                                                        <li class="select_li" data-id="crowonder">CroWonder</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Commission VAT -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="mb-1">Commission VAT</label>
                                                <div id="select_Commission_VAT" class="select">
                                                    <button class="custom-select focus" id="object_general_commission_vat_btn"></button>
                                                    <i class="fas fa-angle-down"></i>
                                                    <ul class="select_ul hidden" id="object_general_commission_vat_ul">
                                                        <li class="select_li" data-id="Y">With VAT</li>
                                                        <li class="select_li" data-id="N">No VAT</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <button class="btn btn_secondary" onclick="object_general.bl.save_object()"><i class="fas fa-save pr-2"></i>Save</button>
                                    </div>
                                </div>
                            </div>

                            <!-- eVisitor -->
                            <div class="card position-relative">
                                <div id="objects_general_evis_loading" class="view_loading" style="display: none;">
                                    <img src="/assets/images/icons/loading.svg" />
                                </div>
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div class="font-weight-bold"><img style="max-height:2rem" src="/assets/images/icons/portals/evisitor-icon.png"></div>

                                    <div class="d-flex justify-content-between">
                                        <div class="font-weight-bold pr-3">
                                            Enable
                                        </div>
                                        <label class="switch switch_md m-0">
                                            <input type="checkbox" id="object_general_evisitor_enable">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>

                                </div>
                                <div class="card-body font_3">
                                    <div class="row">
                                        <div class="col-sm-4 col-md-6">
                                            <label class="mb-1">Object ID</label>
                                            <input type="text" class="form-control focus" id="object_general_evisitor_object_id" />
                                        </div>

                                        <div class="form-group col-sm-4 col-md-6">
                                            <label class="mb-1">eVisitor ID</label>
                                            <div id="select_evisitor" class="select">
                                                <button class="custom-select focus" id="object_general_evisitor_id_btn" data-id="" data-code1="undefined"></button>
                                                <i class="fas fa-angle-down"></i>
                                                <ul class="select_ul hidden" id="object_general_evisitor_id_dropdown">
                                                    <li class="select_li" data-id="simple">From rent price</li>
                                                    <li class="select_li" data-id="full">From full price</li>
                                                </ul>
                                            </div>
                                        </div>

                                        <div class="col-12">
                                            <div class="d-flex justify-content-between pb-2">
                                                <div class="font-weight-bold">
                                                    Check in
                                                    <span class="font-weight-normal d-block">Automatic guest check-in</span>
                                                </div>
                                                <label class="switch switch_md">
                                                    <input type="checkbox" id="object_general_evisitor_check_in">
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                        </div>

                                        <!--<div class="col-sm-4 col-md-6 my-auto">-->
                                        <!-- Checkbox label md -->
                                        <!--<label class="checkbox">
                                                <div class="d-flex align-items-center user_select_none">
                                                    <input type="checkbox" id="object_general_evisitor_check_in">
                                                    <div class="check check_md"></div>
                                                    <div class="pl-2">Check in</div>
                                                </div>
                                            </label>
                                        </div>-->
                                        <!--<div class="col-sm-4 col-md-6 my-auto">-->
                                        <!-- Checkbox label md -->
                                        <!--<label class="checkbox">
                                                <div class="d-flex align-items-center user_select_none">
                                                    <input type="checkbox" id="object_general_evisitor_check_out">
                                                    <div class="check check_md"></div>
                                                    <div class="pl-2">Check out</div>
                                                </div>
                                            </label>
                                        </div>-->
                                        <!--<div class="col-sm-4 col-md-6 my-auto">-->
                                        <!-- Checkbox label md -->
                                        <!--<label class="checkbox">
                                                <div class="d-flex align-items-center user_select_none">
                                                    <input type="checkbox" id="object_general_evisitor_enable">
                                                    <div class="check check_md"></div>
                                                    <div class="pl-2">eVisitor enable</div>
                                                </div>
                                            </label>
                                        </div>-->

                                    </div>

                                </div>
                                <div class="d-flex justify-content-end px-3 mb-3">
                                    <button class="btn btn_secondary" onclick="object_general.bl.save_evisitor();">Connect</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-4 col-md-6">
                    <!-- Links -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <div class="font-weight-bold"><i class="fas fa-link pr-2"></i>Channels</div>
                            <div class="d-flex">
                                <!--<div class="card-header_icon" data-toggle="tooltip" data-placement="top"
                                     data-original-title="Add link to Channel Manager"></div> </div>
                                <div class="card-header_icon" data-toggle="tooltip" data-placement="top"
                                     data-original-title="Import rents"><i class="fas fa-cloud-upload-alt"></i></div>-->
                                <div class="card-header_icon" data-toggle="tooltip" data-placement="top"
                                     data-original-title="Sync all channels" onclick="object_general.ui.sync_all();"><i class="fas fa-sync-alt"></i>
                                </div>
                                <!--<div class="card-header_icon" data-toggle="tooltip" data-placement="top"
                                     data-original-title="Send DONAS"><i class="fas fa-check-square"></i></div>-->
                            </div>
                        </div>
                        <div class="card-body font_4 position-relative">
                            <!-- Loading -->
                            <div id="objects_general_b2b_loading" class="view_loading" style="display: none;">
                                <img src="/assets/images/icons/loading.svg" />
                            </div>
                            <div class="list_portals" id="object_general_list_portals">

                            </div>
                            <div class="d-flex justify-content-between flex-wrap pt-3">
                                <button class="btn btn_secondary mr-2 hidden" onclick="modal_add_b2b_connection.bl.show_modal('modal_add_b2b_connection')"
                                        data-toggle="tooltip" data-placement="top"
                                        data-original-title="Import bookings">
                                    <i class="fas fa-cloud-upload-alt pr-2"></i>Import
                                </button>
                                <button class="btn btn_secondary hidden" onclick="modal_add_b2b_connection.bl.show_modal('modal_add_b2b_connection')"
                                        data-toggle="tooltip" data-placement="top"
                                        data-original-title="Send connection verification to email.">
                                    <i class="far fa-check-circle"></i>
                                    Verify
                                </button>

                                <button class="btn btn_primary" onclick="modal_connect_b2b.bl.show_modal('modal_connect_b2b')"
                                        data-toggle="tooltip" data-placement="top"
                                        data-original-title="Add new booking channel">
                                    <i class="fas fa-plus pr-2"></i>Connect channel manager
                                </button>
                                <button class="btn btn_primary ml-auto" onclick="modal_add_b2b_connection.bl.show_modal('modal_add_b2b_connection')"
                                        data-toggle="tooltip" data-placement="top"
                                        data-original-title="Add new booking channel">
                                    <i class="fas fa-plus pr-2"></i>Add manually
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Links - iCal - Booking engine - Other -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <div class="font-weight-bold">
                                <i class="fas fa-link pr-2"></i>Links
                            </div>
                            <div class="card-header_arrow"></div>
                        </div>
                        <div class="card-body font_3">
                            <!-- iCal -->
                            <div class="font-weight-bold text-uppercase border-bottom mb-3">
                                <i class="fas fa-code-branch pr-2"></i>iCal
                            </div>
                            <ul class="tab_pills nav nav-pills nav-tabs">
                                <li>
                                    <a data-toggle="pill" href="#tab_ical_blank" class="active px-3">Rents</a>
                                </li>
                                <li><a data-toggle="pill" href="#tab_ical_full" class="px-3">Day</a></li>

                            </ul>
                            <div class="tab-content">
                                <div id="tab_ical_blank" class="tab-pane show active">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip" data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://api.zaggy.net/icals/blank/" id="object_general_ical_rents">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                    <div class="card_remark remark_info mb-2">
                                        This will close calendar day by day
                                    </div>
                                </div>
                                <div id="tab_ical_full" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://api.zaggy.net/icals/blank/6a550c2b-ada1-11e7-80c6-0050563c3009" id="object_general_ical_day">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                    <div class="card_remark remark_info">
                                        This will close calendar only by reservation
                                    </div>
                                </div>

                            </div>
                            <!-- Booking Engine -->
                            <div class="font-weight-bold text-uppercase border-bottom mt-4 mb-3 pt-4">
                                <i class="fas fa-code-branch pr-2"></i>Booking engine
                            </div>
                            <ul class="tab_pills nav nav-pills nav-tabs">
                                <li>
                                    <a data-toggle="pill" href="#tab_bookingEngine_offer"
                                       class="active px-3">Offer</a>
                                </li>
                                <li>
                                    <a data-toggle="pill" href="#tab_bookingEngine_link" class="px-3">Link</a>
                                </li>
                                <li>
                                    <a data-toggle="pill" href="#tab_bookingEngine_form" class="px-3">Form</a>
                                </li>
                                <li>
                                    <a data-toggle="pill" href="#tab_bookingEngine_iFrame"
                                       class="px-3">iFrame</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div id="tab_bookingEngine_offer" class="tab-pane show active">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://blp.zaggy.net/prices/p/ff314628-ada9-11e7-80c6-0050563c3009?year=2020">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_bookingEngine_link" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://blp.zaggy.net/object/index/" id="object_general_link">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_bookingEngine_form" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://book.zaggy.net/book/index/" id="object_general_form">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_bookingEngine_iFrame" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="/objects/object_book/" id="object_general_iframe">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Other -->
                            <div class="font-weight-bold text-uppercase border-bottom mt-4 mb-3 pt-4">
                                <i class="fas fa-network-wired pr-2"></i>Other
                            </div>
                            <ul class="tab_pills nav nav-pills nav-tabs">
                                <li><a data-toggle="pill" href="#tab_other_web" class="active px-3">Web</a></li>
                                <li><a data-toggle="pill" href="#tab_other_video" class="px-3">Video</a></li>
                                <li>
                                    <a data-toggle="pill" href="#tab_other_onlineFolder" class="px-3">
                                        Online
                                        folder
                                    </a>
                                </li>
                                <li>
                                    <a data-toggle="pill" href="#tab_other_CalendarWidget" class="px-3">
                                        Calendar
                                        widget
                                    </a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div id="tab_other_web" class="tab-pane show active">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus" value="" id="object_general_web_page">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_other_video" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_other_onlineFolder" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus" value="" id="object_general_online_folder">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div id="tab_other_CalendarWidget" class="tab-pane">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="View Data" onclick="object_general.bl.open_link(this)">
                                            <span class="input-group-text"><i class="far fa-eye"></i></span>
                                        </div>
                                        <input type="text" class="form-control focus"
                                               value="https://ow.zaggy.net/calendar/calendar_widget/" id="object_general_calendar_widget">
                                        <div onclick="object_general.bl.copy_text(this)"
                                             class="input-group-append cursor_point" data-toggle="tooltip"
                                             data-placement="top" data-original-title="Copy">
                                            <span class="input-group-text"><i class="far fa-copy"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<div>

    <!-- Modal add new b2b manually -->
    <section class="modal_add_b2b_connection"></section>

    <!-- Modal connect to b2b -->
    <section class="modal_connect_b2b"></section>


    <!-- Modal channel settings -->
    <section class="modal_channel_settings"></section>

    <template id="template_list_portals">
        <div class="card_portal">
            <div class="d-flex align-items-center line_normal">
                <img src="./assets/images/icons/portals/${pciture}.svg" alt="">
                <div class="font-weight-bold pl-1">${name}</div>
                <div class="pl-1">(10553)</div>
            </div>
            <div class="d-flex align-items-center">
                <div class="line_normal">19%</div>
                <div class="view_dropdown ml-3">
                    <button onclick="object_general.bl.dropdown_link(this)"
                            class="btn btn_hover p-0 d-flex">
                        <span class="portal_dropdown">On</span>
                    </button>
                    <div class="dropdown_menu filter_min_width hidden" style="right: 0;">
                        <div class="d-flex justify-content-between pt-3 px-3 pb-2">
                            <div class="font_bold">Tools</div>
                            <div class="dropdown_close"><i class="fas fa-times"></i></div>
                        </div>
                        <hr class="m-0">
                        <ul class="dropdown_ul font_3 dropdown_ul_max_height">
                            <li class="dropdown_li">
                                <a href="#" class="dropdown_a">
                                    <div class="d-flex align-items-center">
                                        <div class="icon">
                                            <i class="fas fa-info-circle"></i>
                                        </div>
                                        <div class="align-self-center flex_1">Details</div>
                                    </div>
                                </a>
                            </li>                           
                            <li class="dropdown_li delete">
                                <a href="#" class="dropdown_a">
                                    <div class="d-flex align-items-center">
                                        <div class="icon"><i class="far fa-trash-alt"></i></div>
                                        <div class="align-self-center flex_1">Delete</div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="template_for_b2b_connections">
        <div class="card_portal btn_hover py-3 px-1">
            <div class="d-flex align-items-center line_normal cursor_point" id="${connection_row}" onclick="modal_channel_settings.bl.show_modal('channel_settings_modal', this.id)">
                <img src="./assets/images/icons/portals/${icon}" alt="">
                <div class="font-weight-bold pl-1">${name1}</div>
                <div class="pl-1">${sync_value}</div>
            </div>
            <div class="d-flex align-items-center">
                <div class="line_normal">${price_percent} %</div>
                <div class="view_dropdown ml-3">
                    <a class="btn btn_hover p-0 d-flex" onclick="object_general.bl.dropdown_link(this)">
                        <span class="portal_dropdown" ${active_color}>${active}</span>
                    </a>
                    <div class="dropdown_menu filter_min_width hidden" style="right: 0;">
                        <div class="d-flex justify-content-between pt-3 px-3 pb-2">
                            <div class="font_bold">Tools</div>
                            <div class="dropdown_close"><i class="fas fa-times"></i></div>
                        </div>
                        <hr class="m-0">
                        <ul class="dropdown_ul font_3 dropdown_ul_max_height">
                            <li class="dropdown_li">
                                <a class="dropdown_a" onclick="modal_channel_settings.bl.show_modal('channel_settings_modal', `${details}`)">
                                    <div class="d-flex align-items-center">
                                        <div class="icon">
                                            <i class="fas fa-info-circle"></i>
                                        </div>
                                        <div class="align-self-center flex_1">Details</div>
                                    </div>
                                </a>
                            </li>
                            <li class="dropdown_li">
                                <a class="dropdown_a" onclick="object_general.ui.sync_b2b(${b2b_id})">
                                    <div class="d-flex align-items-center">
                                        <div class="icon">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                        </div>
                                        <div class="align-self-center flex_1">Sync all</div>
                                    </div>
                                </a>
                            </li>
                            <li class="dropdown_li delete">
                                <a onclick="modal_channel_settings.bl.delete(`${object_b2b_id}`)" class="dropdown_a">
                                    <div class="d-flex align-items-center">
                                        <div class="icon"><i class="far fa-trash-alt"></i></div>
                                        <div class="align-self-center flex_1">Delete</div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="template_evisitor_dropdown_id">
        <li class="select_li" data-id="${id}">${username}</li>
    </template>

</div>

<section>
    <template id="template_object_general_type">
        <li class="select_li" data-id="${id}">${name}</li>
    </template>

    <template id="template_object_general_card_pictures">
        <div class="pics_item">
            <img src="${url}"
                 alt="">
        </div>
    </template>
</section>

<script>

    $(".modal_channel_settings").load("/pages/components/modal_channel_settings.html");

    var object_general = {};

    object_general.unit_id = '';
    object_general.user_id = bl.workers.current_user_id();
    object_general.object_id = '';

    // on load function
    object_general.load = async function () {

        await object_general.bl.object_load();

        // Load
        $(".filter_general").load("/pages/partals/filter_general.html?object_id=" + location.hash.split('?')[1]);
        $(".mobile_button").load("/pages/partals/mobile_navigation.html");
        $("#header_navbar_right_shrotcuts").load("/pages/partals/header_navbar_right_shrotcuts.html");
        $(".modal_add_b2b_connection").load("/pages/components/modal_add_b2b_connection.html");
        $(".modal_connect_b2b").load("/pages/components/modal_connect_b2b.html");

        // clear data
        object_general_list_portals.innerHTML = '';

        // Global ui
        ui.display_title("General");
        ui.custom_select("select_VAT_calculation");
        ui.custom_select("select_calculation");
        ui.custom_select("select_commission_type");
        ui.custom_select("select_commission_calculation");
        ui.custom_select("select_Commission_VAT");
        ui.custom_select("select_price_calculation");
        //ui.custom_select("object_general_select_stars");

        ui.content_loading('objects_general_content_loading');

        object_general.ui.slick(".card-body_pics_list");
        //object_general.ui.close_modal_delete("view_modal.delete");

        await object_general.ui.load_types();
        await object_general.bl.load_evisitor();

        // load data
        await object_general.bl.object_display();

    }

    // buisness logic
    object_general.bl = new function () {

        // Dropdown links + open modal delete
        this.dropdown_link = function (e) {

            var dropdown_menu = e.parentElement.lastElementChild;
            var dropdown_li = e.parentElement.lastElementChild.lastElementChild.children;
            var dropdown_close = e.parentElement.getElementsByClassName("dropdown_close")[0];

            if (dropdown_menu.classList.contains("hidden")) {
                dropdown_menu.classList.remove("hidden");
                for (let i = 0; i < dropdown_li.length; i++) {
                    dropdown_li[i].onclick = function () {
                        if (dropdown_li[i].classList.contains("delete")) {
                            open_modal_delete();
                        }
                        dropdown_menu.classList.add("hidden");
                    }
                }
                dropdown_close.onclick = function () {
                    dropdown_menu.classList.add("hidden");
                }
            }

            $(document).mouseup(function (e) {
                if (!$(dropdown_menu).is(e.target) && $(dropdown_menu).has(e.target).length === 0) {
                    dropdown_menu.classList.add("hidden");
                }
            });

            function open_modal_delete() {
                var modal = document.querySelector(".view_modal.delete");
                if (modal.classList.contains('hidden')) {
                    modal.classList.remove('hidden');
                    setTimeout(function () {
                        modal.classList.remove('visuallyhidden');
                    }, 20);
                } else {
                    modal.classList.add('visuallyhidden');
                    modal.addEventListener('transitionend', function (e) {
                        modal.classList.add('hidden');
                    }, {
                        capture: false,
                        once: true,
                        passive: false
                    });
                }
            }

        }

        // deactivating object
        this.deactivate = async () => {

            await Swal.fire({

                title: "Are you sure you wish to deactivate this object?",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: "Deactivate",
                cancelButtonText: "Cancel"

            }).then(async (result) => {

                if (result.isConfirmed) {

                    ui.content_loading("objects_general_content_loading");

                    var url = '/api/objects/deactivate/' + object_general.object_id;
                    await ajax.get_json(url);
                    await bl.objects.list_load();

                    await bl.objects.sync_full(object_general.object_id);

                    // reload property
                    await object_general.bl.object_display();

                    ui.content_loading_hide("objects_general_content_loading");

                }

            });

        }

        // activating object
        this.activate = async () => {

            var object = object_general.object_details;

            await Swal.fire({

                title: "Are you sure you want to activate object?",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: "Activate",
                cancelButtonText: "Cancel"

            }).then(async (result) => {

                if (result.isConfirmed) {

                    ui.content_loading("objects_general_content_loading");

                    // lets activate object
                    var url = '/api/objects/activate/' + object_general.object_id;
                    await ajax.get_json(url);

                    // reload object list
                    await bl.objects.list_load();

                    // sync with web
                    await bl.objects.sync_full(object_general.object_id);

                    // reload property
                    await object_general.bl.object_display();

                    // remove waiting div
                    ui.content_loading_hide("objects_general_content_loading");

                }

            });

        }

        this.delete_object = async () => {


            await Swal.fire({
                title: 'Are you sure you want to delete?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    var url = '/api/objects/delete/' + object_general.object_id;
                    ajax.get(url);

                    bl.objects.list_load();

                    Swal.fire({
                        title: 'Deleted!',
                        text: 'Your object is deleted.',
                        confirmButtonText: 'Done'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = "#objects";
                        }
                    })

                }
            })

        }

        // display object details
        this.load_details = () => {

            var hash = location.hash;
            var object_id = hash.split('?')[1];

            bl.objects.list_get(object_id);
        }

        // object load details
        this.object_load = () => {

            var hash = location.hash;
            var object_id = hash.split('?')[1];

            bl.objects.object_load(object_id, this.object_display);
        }

        // display data
        this.object_display = async () => {

            var o = bl.objects.object_get();

            header_object_name.innerHTML = o['general'][0]['name'];

            // setting mandatory fileds
            object_general.unit_id = o['general'][0]['unit_id'];
            object_general.object_id = o['general'][0]['id'];

            // icals
            object_general_ical_rents.value = 'https://api.zaggy.net/icals/rents/' + o['general'][0]['guid'];
            object_general_ical_day.value = 'https://api.zaggy.net/icals/day/' + o['general'][0]['guid'];

            // booking engines
            object_general_link.value = 'https://blp.zaggy.net/object/index/' + o['general'][0]['id'];
            object_general_form.value = 'https://book.zaggy.net/book/index/' + o['general'][0]['id'];
            object_general_iframe.value = '/objects/object_book/' + o['general'][0]['id'];
            object_general_calendar_widget.value = 'https://ow.zaggy.net/calendar/calendar_widget/' + o['general'][0]['id'];
            object_general_web_page.value = o['general'][0]['web_page'];
            object_general_online_folder.value = o['general'][0]['online_folder'];

            // Location card

            // getting main picture for location
            url = '/api/units_pictures/main_picture/' + object_general.unit_id;
            var picture = await ajax.get(url);
            var picture_json = JSON.parse(picture);
            var picture_main_obj = o['general'][0]['picture_url_amazon'];

            // if picture of location doesnt exist show main picture of object also as picture of location
            if (picture_json.length != 0) {
                object_general_location_main_picture.src = picture_json[0]['link_amazon'];
            } else {
                object_general_location_main_picture.src = picture_main_obj;
            }

            // location details
            var unit_name = o['general'][0]['unit_name'];
            var adress = o['general'][0]['adress'];
            var city = o['general'][0]['city'];
            var city_zip = o['general'][0]['city_zip'];
            var country = o['general'][0]['country'];
            // Naziv Note - sredit ćeš jer korišten 'note1' u bazi kao glavni bi trebalo biti samo 'note' ili slično
            var owner_name = !o['general'][0]['owner_name'] == true ? 'Owner name missing' : o['general'][0]['owner_name'];
            var owner_email = !o['general'][0]['owner_email'] == true ? 'Owner e-mail missing' : o['general'][0]['owner_email'];
            var owner_tel = !o['general'][0]['owner_tel'] == true ? 'Owner telephone missing' : o['general'][0]['owner_tel'];
            object_general_location_details_link.href = '#location_details?' + o['location'][0]['id'];

            let general = o['general'][0];
            if (!general['owner_name'] && !general['owner_email'] && !general['owner_tel']) {
                object_general_owner_container.classList.add('hidden');
            }
            else {
                object_general_owner_container.classList.remove('hidden');
            }

            !o['general'][0]['note'] == false ? object_general_owner_note_div.classList.remove('hidden') : '';
            !o['location'][0]['note'] == false ? object_general_location_note_div.classList.remove('hidden') : '';
            // Naziv Note za vlasnik - sredit ćeš jer korišten 'note6' u bazi umjesto toga staviš owner_note

            object_general_unit_name.textContent = unit_name;
            object_general_adress.textContent = adress;
            object_general_city.textContent = city;
            object_general_city_zip.textContent = city_zip;
            object_general_country.textContent = country;
            object_general_owner_name.textContent = owner_name;
            object_general_owner_email.textContent = owner_email;
            object_general_owner_tel.textContent = owner_tel;
            object_general_location_note.innerHTML = o['location'][0]['note'];
            object_general_location_owner_note.innerHTML = o['general'][0]['note6'];
            object_general_note_object.value = o['general'][0]['note'];

            //set deactivate / activate button
            var active = o['general'][0]['active'];

            if (active == 'Y') {

                object_activate_button.classList.add("hidden");
                object_deactivate_button.classList.remove("hidden");
            } else {
                object_activate_button.classList.remove("hidden");
                object_deactivate_button.classList.add("hidden");
            }

            // picture card
            object_general_main_picture.src = o['general'][0]['picture_url_amazon'] || "/assets/images/pictures/no-image.png";

            // Object card
            var name = o['general'][0]['name'];
            var color = o['general'][0]['color'];
            var code = o['general'][0]['code'];
            var sort_index = o['general'][0]['sort'];
            var type_label = o['general'][0]['type'];

            object_general_name.value = name;
            object_general_color.value = color;
            object_general_code.value = code;
            object_general_sort_index.value = sort_index;
            object_general_type_label.value = type_label;

            // Pricing & Calculations card -----------
            // Price
            // Select Price calculation
            var info_base_price = o['general'][0]['price'];
            var advance_percent = o['general'][0]['advance_percent'];
            var vat = o['general'][0]['vat'];
            var tourist_membership_fee = o['general'][0]['tourist_membership_fee'];
            var vat_advance = o['general'][0]['vat_advance'];
            var owner_provision = o['general'][0]['owner_provision']; // Je li stvarno vlasnička provizija? Nisam siguran što sam vidio iz baze.
            var vat_profit = o['general'][0]['vat_profit'];
            var vat_calculation = o['general'][0]['']; // Select VAT Calculation
            var vat_neto = o['general'][0]['vat_neto'];
            // Calucaation
            // 4x selects ----
            // - calculation
            // - commission type
            // - commission calculation
            // - commission vat

            object_general_info_base_price.value = info_base_price;
            object_general_advance_percent.value = advance_percent;
            object_general_vat.value = vat;
            object_general_tourist_membership_fee.value = tourist_membership_fee;
            object_general_vat_advance.value = vat_advance;
            object_general_owner_provision.value = owner_provision;
            object_general_vat_profit.value = vat_profit;
            object_general_vat_neto.value = vat_neto;

            // imitation click on dropdown menu

            var object_type_id = o['general'][0]['object_type_id'];
            let elem = document.querySelector(`#object_general_types_ul > li[data-id="${object_type_id}"]`);
            if (object_type_id != null && elem != null) {
                elem.click();
            }

            var price_calculation = o['general'][0]['price_calculation'];
            elem = document.querySelector(`#object_general_price_calculation_ul > li[data-id="${price_calculation}"]`)
            if (price_calculation != null && elem != null) {
                elem.click();
            }

            var vat_calculation = o['general'][0]['object_vat_type'];
            elem = document.querySelector(`#object_general_vat_calculation_ul > li[data-id="${vat_calculation}"]`)
            if (vat_calculation != null && elem != null) {
                elem.click();
            }

            var calculation = o['general'][0]['calculation_type'];
            elem = document.querySelector(`#object_general_calculation_ul > li[data-id="${calculation}"]`);
            if (calculation != null && elem != null) {
                elem.click();
            }

            var commission_type = o['general'][0]['provision_calculation'];
            elem = document.querySelector(`#object_general_commission_type_ul > li[data-id="${commission_type}"]`);
            if (commission_type != null && elem != null) {
                elem.click();
            }

            var commission_calculation = o['general'][0]['profit_calculation'];
            elem = document.querySelector(`#object_general_commision_calculation_ul > li[data-id="${commission_calculation}"]`);
            if (commission_calculation != null && elem != null) {
                elem.click();
            }

            var provision_with_vat = o['general'][0]['provision_with_vat'];
            elem = document.querySelector(`#object_general_commission_vat_ul > li[data-id="${provision_with_vat}"]`);
            if (provision_with_vat != null && elem != null) {
                elem.click();
            }

            await object_general.bl.load_b2b_connections();

            ui.content_loading_hide('objects_general_content_loading');
        }

        this.load_b2b_connections = async () => {

            ui.content_loading("objects_general_b2b_loading");
            
            var object_id = page.get_id();

            var url = '/api/objects_b2b/list/' + object_id;
            var response_json = await ajax.get_json(url);

            object_general_list_portals.innerHTML = '';

            let i = 0;
            for (var obj of response_json) {

                let icon = obj['picture'] || 'syncbeds.svg';

                icon = icon.replace('.png', '.svg');

                var t = template_for_b2b_connections.innerHTML;
                t = t.replace('${connection_row}', i);
                t = t.replace('${details}', i);
                t = t.replace('${active}', obj['active'] == 'Y' ? 'On' : 'Off');
                t = t.replace('${active_color}', obj['active'] == 'N' ? 'style = "background-color:red;"' : '');
                t = t.replace('${icon}', icon);
                t = t.replace('${name1}', obj['name1']);
                t = t.replace('${sync_value}', !obj['value'] ? '' : '(' + obj['value'] + ')');
                t = t.replace('${object_id}', obj['object_id']);
                t = t.replace('${object_id}', obj['object_id']);
                t = t.replace('${id}', obj['object_id']);
                t = t.replace('${b2b_id}', obj['b2b_id']);
                t = t.replace('${object_b2b_id}', obj['id']);
                t = t.replace('${price_percent}', obj['price_percent']);

                js.html.insertAdjacentHTML('object_general_list_portals', t);

                i++;
            }

            ui.content_loading_hide("objects_general_b2b_loading");
        }

        // save object
        this.save_object = async () => {

            var object = {};

            object.object_id = page.get_id();

            // mandatory fileds
            object.user_id = object_general.user_id;
            object.unit_id = object_general.unit_id;
            object.object_id = object_general.object_id;

            //details
            object.name = document.getElementById('object_general_name').value;
            object.color = document.getElementById('object_general_color').value;
            object.object = document.getElementById('object_general_code').value;
            object.sort = document.getElementById('object_general_sort_index').value;
            object.type = document.getElementById('object_general_type_label').value;
            object.note = object_general_note_object.value;
            object.object_type_id = object_general_types_btn.dataset.id;
            //object.note_email = object_general_note_email.value;
            //object.note_invoice = object_general_note_invoices.value;
            //object.note_important = object_general_note_important.value;
            //location_details_category_stars_btn

            // Pricing & Calculations
            object.advance_percent = object_general_advance_percent.value;
            object.vat = object_general_vat.value;
            //object.price = object_general_info_base_price.value;
            //object.tourist_membership_fee = object_general_tourist_membership_fee.value;
            //object.vat_neto = object_general_vat_neto.value;
            //object.vat_advance = object_general_vat_advance.value;
            //object.vat_profit = object_general_vat_profit.value;
            //object.owner_provision = object_general_owner_provision.value;
            //object.price_calculation = object_general_price_calculation_btn.dataset.id;
            //object.object_vat_type = object_general_vat_calculation_btn.dataset.id;
            //object.calculation_type = object_general_calculation_btn.dataset.id;
            //object.provision_calculation = object_general_commission_type_btn.dataset.id;
            //object.profit_calculation = object_general_commision_calculation_btn.dataset.id;
            //object.provision_with_vat = object_general_commission_vat_btn.dataset.id;

            var url = '/api/objects/save_json/';
            await ajax.post_json(url, object);

            Swal.fire(
                'Success!',
                'Your changes have been saved',
                'success'
            );

            // Refresh cache
            bl.objects.list_load();

        }

        this.load_evisitor = async () => {

            var object_id = page.get_id();
            var user_id = bl.workers.current_user_id();

            var url = '/api/objects_evisitor/get/' + object_id;
            var response = await ajax.get(url);
            var json_response = JSON.parse(response);

            var list_url = '/api/users_b2b/list/' + user_id;

            var list_json = await ajax.get_json(list_url);

            object_general_evisitor_id_dropdown.innerHTML = '';

            for (var i of list_json) {

                var t = template_evisitor_dropdown_id.innerHTML;

                t = t.replace('${username}', i['username']);
                t = t.replace('${id}', i['id']);
                js.html.insertAdjacentHTML('object_general_evisitor_id_dropdown', t);

            }

            object_general_evisitor_object_id.value = !json_response[0]['eVizitor_object'] == true ? '' : json_response[0]['eVizitor_object'];
            object_general_evisitor_check_in.checked = json_response[0]['checkin'] == 'Y' ? true : false;
            //object_general_evisitor_check_out.checked = json_response[0]['checkout'] == 'Y' ? true : false;
            object_general_evisitor_enable.checked = json_response[0]['enable'] == 'Y' ? true : false;

            ui.custom_select("select_evisitor");

            var evisitor_id = json_response[0]['user_b2b_id']
            //if (evisitor_id != null && evisitor_id != '') {
            //    document.querySelectorAll(`#object_general_evisitor_id_dropdown > li[data-id="${evisitor_id}"`)[0].click();

            //}

            //SET EVISITOR ID
            let b2b_id = "";
            if (json_response[0]['user_b2b_id'] != null) {
                b2b_id = json_response[0]['user_b2b_id'].toString();
            }

            for (var el of object_general_evisitor_id_dropdown.children) {

                if (el.dataset.id === b2b_id) {
                    el.click();
                }

            }

        }

        this.save_evisitor = async () => {

            ui.content_loading('objects_general_evis_loading');

            var eviz = {};

            eviz.eVizitor_object = object_general_evisitor_object_id.value;
            eviz.checkin = object_general_evisitor_check_in.checked == true ? 'Y' : 'N';
            //eviz.checkout = object_general_evisitor_check_out.checked == true ? 'Y' : 'N';
            eviz.enable = object_general_evisitor_enable.checked == true ? 'Y' : 'N';
            eviz.object_id = object_general.object_id;
            eviz.user_b2b_id = !object_general_evisitor_id_btn.dataset.id == true ? '' : object_general_evisitor_id_btn.dataset.id;

            var url = '/api/objects_evisitor/save';
            var response = await ajax.post_json(url, eviz);

            object_general.bl.load_evisitor();

            ui.content_loading_hide('objects_general_evis_loading');

        }

        this.open_link = (el) => {

            let link = el.parentElement.children[1].value;

            if (link != "") {
                window.open(link, "_blank");
            }

        }

        this.copy_text = (el) => {

            let link = el.parentElement.children[1].value;

            /* Select the text field */
            el.parentElement.children[1].select();
            el.parentElement.children[1].setSelectionRange(0, 99999); /* For mobile devices */

            /* Copy the text inside the text field */
            navigator.clipboard.writeText(link);

        }

    }

    // local ui
    object_general.ui = new function () {

        //this.select_b2b_connection = (id) => {
        //    location.href = '#sync?' + object_general.object_id + '&' + id;

        //}

        // Modal - close delete
        this.close_modal_delete = function (id) {

            var modal_id = document.querySelector("." + id);
            var modal_content = modal_id.getElementsByClassName("modal_content")[0];
            var dismiss = modal_id.querySelectorAll("[data-dismiss='modal']");
            for (let i = 0; i < dismiss.length; i++) {
                dismiss[i].onclick = function () {
                    hide_modal();
                }
            }
            document.addEventListener("mouseup", function (e) {
                if (!$(modal_content).is(e.target) && $(modal_content).has(e.target).length === 0) {
                    if (!modal_id.classList.contains("hidden")) {
                        hide_modal();
                    }
                }
            });

            document.onkeydown = function (e) {
                if (!modal_id.classList.contains("hidden")) {
                    if (e.keyCode === 27) {// || e.keyCode === 13) {
                        hide_modal();
                    }
                }
            };
            function hide_modal() {
                modal_id.classList.add('visuallyhidden');
                modal_id.addEventListener('transitionend', function (e) {
                    modal_id.classList.add('hidden');
                }, {
                    capture: false,
                    once: true,
                    passive: false
                });
            }
        }

        // Slick
        this.slick = function (id) {

            $(id).slick({
                dots: true,
                infinite: true,
                slidesToShow: 3,
                slidesToScroll: 3,
                arrows: true,
                prevArrow: '<div class="slick_arrow left"><i class="fas fa-angle-left"></i></div>',
                nextArrow: '<div class="slick_arrow right"><i class="fas fa-angle-right"></i></div>',
                responsive: [
                    {
                        breakpoint: 600,
                        settings: {
                            slidesToShow: 2,
                            slidesToScroll: 2
                        }
                    },

                ]
            });
        }

        // Tooltip - click to change value
        this.event_tooltip = function (e) {
            var attr_value = e.attributes[4];
            attr_value.value = "Copied!";
        }

        // Filter check all
        this.filter_check_all = function (id) {

            var check_id = document.getElementById(id);
            var check_btn = check_id.getElementsByClassName("all")[0];
            var checkboxes = check_id.querySelectorAll("input[type='checkbox']");

            check_btn.addEventListener("click", function () {
                for (var i in checkboxes) {
                    checkboxes.item(i).checked = true;
                }
            });
        }

        // Filter uncheck all
        this.filter_unCheck_all = function (id) {

            var check_id = document.getElementById(id);
            var check_btn = check_id.getElementsByClassName("remove")[0];
            var checkboxes = check_id.querySelectorAll("input[type='checkbox']");

            check_btn.addEventListener("click", function () {
                for (var i in checkboxes) {
                    checkboxes.item(i).checked = false;
                }
            });
        }

        // Mobile open dropdown by click btn
        this.filter_mobile_btn = function (id, dropdown_id) {

            var mobile_btn = document.getElementById(id);
            var dropdown = document.getElementById(dropdown_id);
            var dropdown_btn = dropdown.getElementsByTagName("button")[0];
            var dropdown_menu = dropdown.getElementsByClassName("dropdown_menu")[0];

            mobile_btn.addEventListener("click", function () {
                if (!dropdown_btn.classList.contains("open")) {
                    dropdown.classList.remove("d-none");
                    dropdown_menu.classList.remove("hidden");
                    dropdown_btn.classList.add("open");
                } else {
                    dropdown.classList.add("d-none");
                    dropdown_menu.classList.add("hidden");
                    dropdown_btn.classList.remove("open");
                }
            })
        }

        this.load_types = async () => {

            var url = '/api/objects_types/get_type/';
            var response = await ajax.get(url);
            var response_json = JSON.parse(response);

            object_general_types_ul.innerHTML = '';

            for (var type of response_json) {

                var t = template_object_general_type.innerHTML;

                t = t.replace('${name}', type['name']);
                t = t.replace('${id}', type['id']);

                js.html.insertAdjacentHTML('object_general_types_ul', t);
            }

            // click on li
            ui.custom_select("select_type");

        }

        this.load_card_pictures = () => {

            o = bl.objects.object_get();

            object_general_card_pictures.innerHTML = '';

            for (var pic of o['pictures']) {
                var t = template_object_general_card_pictures.innerHTML;
                t = t.replace('${url}', pic['url']);

                js.html.insertAdjacentHTML('object_general_card_pictures', t);
            }
        }

        // sync all portals
        this.sync_all = async () => {

            ui.content_loading('objects_general_b2b_loading');

            var url = '/api/objects/sync_all/' + object_general.object_id;

            await ajax.get(url);

            ui.content_loading_hide('objects_general_b2b_loading');

        }        

        // sync portal
        this.sync_b2b = async (b2b_id) => {

            ui.content_loading('objects_general_b2b_loading');

            var url = `/api/objects/sync_b2b/${object_general.object_id}?b2b_id=${b2b_id}`;
            await ajax.get(url);

            ui.content_loading_hide('objects_general_b2b_loading');

        }

    }

    object_general.load();

</script>